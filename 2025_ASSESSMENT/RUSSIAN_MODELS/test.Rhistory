library(r4ss)
dir()
mods=dir()[1]
mods=dir()[1:5]
mods1<-SSgetoutput(dirvec=mods)
SS_plots(mods1[[1]])
names(mods1[[1]])
mods1[[1]]$batage
batage<-mods1[[1]]$batage
library(data.table)
batage<-data.table(mods1[[1]]$batage)
batage[era=='M TIME']
batage[Era=='M TIME']
batage
batage[Era=='TIME']
names(batage)[10]
names(batage)[9]
names(batage)[11]
names(batage)[11]<-'Beg_Mid'
batage[Beg_Mid=='M'&Era='TIME']
batage[Beg_Mid=='M'&Era=='TIME']
batage[Beg_Mid=='M'&Era=='TIME'][,c(1,2,8,13:32)]
batage[Beg_Mid=='M'&Era=='TIME'][,c(1,2,8,13:33)]
batage1<-batage[Beg_Mid=='M'&Era=='TIME'][,c(1,2,8,13:33)]
names(mods1[[1]])
sort(names(mods1[[1]]))
mods1[[1]]$movement
data.table(mods1[[1]]$movement)
move=data.table(mods1[[1]]$movement)
batage1
mods1[[1]]$parameters
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_GP_1from_1to_2_DEVrwalk']
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_GP_1from_1to_2_DEVrwalk'][1:5]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_GP_1from_1to_2_DEVrwalk'][,1:5]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_GP_1from_1to_2_DEVrwalk'][,1:2]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_GP_1from_1to_2_DEVrwalk'][,1:3]
move
move[,c(2:4,7:26]
move[,c(2:4,7:26)]
move[,c(2:4,7:27)]
move=move[,c(2:4,7:27)]
move
batage1
names(move)
names(move)[4:24]
names(batage1)[3:23]
names(batage1)[4:24]
names(batage1)[4:24]<-names(move)[4:24]
batage1
library(dplyr)
melt(batage1)
melt(batage1,c('Area','Bio_Pattern'))
melt(batage1,c('Area','Bio_Pattern','Yr'))
batage2<-melt(batage1,c('Area','Bio_Pattern','Yr'))
move
move2<-melt(move,c('GP','Source_area','Dest_area'))
move2
names(batage2)
names(batage2)<-c('Source_area','GP','Yr','Age','Biomass')
batage2
move2[Source_area!=Dest_area]
move3<-move2[Source_area!=Dest_area]
move3
names(move3)[4]<-'Age'
names(move3)[5]<-'Prob'
move3
merge(move3,batage2)
mods1[[1]]$parameters
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_']
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'][,1:4]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'][,1:3]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'&Label%like%'dev'][,1:3]
data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'&Label%like%'DEV'][,1:3]
devs=data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'&Label%like%'DEV'][,1:3]
strsplit(devs$Label, split='_')
do.call(rbind,strsplit(devs$Label, split='_'))
do.call(rbind,strsplit(devs$Label, split='_'))[10]
do.call(rbind,strsplit(devs$Label, split='_'))[,10]
dev_parm=data.table(mods1[[1]]$parameters)[Label%like%'MoveParm_A_seas_1_'&Label%like%'DEV'][,1:3]
dev_parm$Yr<-do.call(rbind,strsplit(devs$Label, split='_'))[,10]
dev_parm$Dest_area<-do.call(rbind,strsplit(devs$Label, split='_'))[,8]
dev_parm$Source_area<-do.call(rbind,strsplit(devs$Label, split='_'))[,7]
dev_parm[Source_area=='1from']$Source_area<-1
dev_parm[Source_area=='2from']$Source_area<-2
dev_parm
dev_parm[Source_area=='2to']$Source_area<-2
dev_parm[Source_area=='1to']$Source_area<-1
dev_parm
batage2
move3
merge(batage2,move3)
dev_parm
 do.call(rbind,strsplit(devs$Label, split='_'))[6]
 do.call(rbind,strsplit(devs$Label, split='_'))[7]
 do.call(rbind,strsplit(devs$Label, split='_'))
 do.call(rbind,strsplit(devs$Label, split='_'))[,7]
dev_parm$Source_area<-do.call(rbind,strsplit(devs$Label, split='_'))[,6]
dev_parm
dev_parm$Source_area<-do.call(rbind,strsplit(devs$Label, split='_'))[,7]
dev_parm
dev_parm$GP<-do.call(rbind,strsplit(devs$Label, split='_'))[,6]
dev_parm[Source_area=='1to']$Source_area<-1
dev_parm[Source_area=='2to']$Source_area<-2
dev_parm[GP=='2from']$GP<-2
dev_parm[GP=='1from']$GP<-1
dev_parm
batage3
batage2
devparm[-'Label']
dev_parm[-'Label']
dev_parm[,-'Label']
dev_parm[,-c('Num','Label']
dev_parm[,-c('Num','Label')]
dev_parm=dev_parm[,-c('Num','Label')]
dev_parm
move3
merge(dev_parm,move3)
move3$Dest_area<-as.numeric(move3$Dest_area)
dev_parm$Dest_area<-as.numeric(dev_parm$Dest_area)
dev_parm$Source_area<-as.numeric(dev_parm$Source_area)
dev_parm$GP<-as.numeric(dev_parm$GP)
merge(dev_parm,move3)
merge(dev_parm,batage2)
dev_parm$Yr<-as.numeric(dev_parm$Yr)
merge(dev_parm,batage2)
batage3<-merge(dev_parm,batage2)
batage4<-merge(move3,batage4)
batage4<-merge(move3,batage3)
batage4
batage4$Prob2<-batage4$Prob+batage4$Value
batage4
library(ggplot2)
ggplot(batage4,aes(x=Yr,y=Prob2,color=GP,line.type=Source_area))+geom_line()
ggplot(batage4,aes(x=Yr,y=Prob2,color=GP,line.type=Source_area))+geom_line()+facet_wrap(Age~Dest_area)
batabe4[Age=='age0]$Prob2<-0
batabe4[Age=='age0]$Prob2<-0
batabe4[Age=='age1]$Prob2<-0
batabe4[Age=='age2]$Prob2<-0
batage4[Age=='age0]$Prob2 <- 0
batabe4[Age=='age2']$Prob2<-0
batage4[Age=='age2']$Prob2<-0
batage4[Age=='age0']$Prob2<-0
batage4[Age=='age1']$Prob2<-0
ggplot(batage4,aes(x=Yr,y=Prob2,color=GP,line.type=Source_area))+geom_line()+facet_wrap(Age~Dest_area)
batage4$B_move<-batage4$Biomass*batage4$Prob2
batage4$B_move
ggplot(batage4,aes(x=Yr,y=B_move,color=GP,line.type=Source_area))+geom_line()+facet_wrap(Age~Dest_area)
ggplot(batage4,aes(x=Yr,y=B_move,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(Age~Dest_area)
batage4[,list(sum(Biomass)),by=c('GP','Source_area','Dest_area','Yr')]
batage5=batage4[,list(sum(Biomass)),by=c('GP','Source_area','Dest_area','Yr')]
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(Age~Dest_area)
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area)
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area)+theme_bw(base.size=16)
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area)+theme_bw(base_size=16)
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area,'free_y')+theme_bw(base_size=16)
?facet_wra[
?facet_wrap
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area,scales='free')+theme_bw(base_size=16)
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+facet_wrap(~Dest_area,scales='free')+theme_bw(base_size=16)+labs(y="Movement (t)
")
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+theme_bw(base_size=16)+labs(y="Movement (t)")
batage5[Source_area==1]$Source_area<-'From EBS/NBS + WGOA to WBS'
batage5[Source_area==2]$Source_area<-'From WBS to EBS/NBS + WGOA'
batage5
batage5=batage4[,list(sum(Biomass)),by=c('GP','Source_area','Dest_area','Yr')]
batage5$Source_area<-as.character(batage5$Source_area)
batage5[Source_area==2]$Source_area<-'From WBS to EBS/NBS + WGOA'
batage5[Source_area==1]$Source_area<-'From EBS/NBS + WGOA to WBS'
batage5
ggplot(batage5,aes(x=Yr,y=V1,color=factor(GP),line.type=Source_area))+geom_line()+theme_bw(base_size=16)+labs(y="Movement (t)")
ggplot(batage5,aes(x=Yr,y=V1,color=Source_area,line.type=Source_area))+geom_line()+theme_bw(base_size=16)+labs(y="Movement (t)")
